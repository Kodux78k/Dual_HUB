
    :root {
      /* Paleta padrão (rosa/azul) */
      --grad-a: #ff52e5;
      --grad-b: #00c5e5;
      --fg: #f5f7ff;
      --mut: rgba(245, 247, 255, .68);
      /* Superfícies levemente mais opacas para melhorar a legibilidade em fundos complexos */
      --surface: rgba(15, 17, 32, .65);
      --surface-strong: rgba(15, 17, 32, .92);
      --bd: 1px solid rgba(255, 255, 255, .12);
      --ok: #39ffb6;
      --warn: #ffb86b;
      --err: #ff6b6b;
      --r: 18px;
      --r2: 22px;
      --shadow: 0 14px 40px rgba(0, 0, 0, .45);
      --tabsH: 74px;
      --hdrH: 64px;
      --blur: 24px;
  /* Deslocamento opcional para o cabeçalho.  Ajuste este valor para
     empurrar o cabeçalho (header.mast) alguns pixels para baixo.  O
     padding superior do main será ajustado automaticamente. */
  --hdrOffset: 0px;

  /* Cor de overlay por arquétipo (gradiente sólido).  Esta variável
     será atualizada dinamicamente via script conforme o arquétipo
     ativo.  O valor padrão é transparente para não interferir na
     estética quando nenhum arquétipo estiver selecionado. */
  --arch-overlay: rgba(0,0,0,0);
      --ease: cubic-bezier(.22, .61, .36, 1);
    }

    /* Tema alternativo: medium gray / glasmorfismo. Quando body[data-theme="medium"] estiver definido, estas variáveis substituem as originais. */
    body[data-theme="medium"] {
      /* Ajustamos a paleta “medium” para um visual ainda mais tecnológico,
         com tons de cinza-escuro/azulado e transparências suaves para
         reforçar o glasmorfismo. */
      --grad-a: #2c313c;
      --grad-b: #1f242d;
      --fg: #f1f2f5;
      --mut: rgba(241, 242, 245, .68);
      /* No tema médio, aumente a opacidade das superfícies para reforçar o efeito de vidro */
      --surface: rgba(44, 47, 56, .55);
      --surface-strong: rgba(44, 47, 56, .85);
      --bd: 1px solid rgba(255, 255, 255, .06);
      --ok: #68d391;
      --warn: #f6ad55;
      --err: #fc8181;
      --blur: 24px;
    }

    * { box-sizing: border-box }
    html, body { height: 100% }

    body {
      margin: 0;
      color: var(--fg);
      background: linear-gradient(42deg, var(--grad-a), var(--grad-b)) fixed;
      font: 14px/1.45 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
      overflow: hidden;
  /* Permite que o pseudo-elemento ::after fique posicionado em relação ao corpo */
  position: relative;
    }

/* Overlay de cor do arquétipo ativo.  Usa a variável --arch-overlay definida no
   :root e atualizada via script.  O overlay cobre toda a tela, tem pointer-events
   desativado e fica atrás dos demais elementos (z-index: 0). */
body::after{content:'';position:fixed;inset:0;background:none !important;pointer-events:none;}

    /* ===== Micro-interações base ===== */
    .fx-trans { transition: transform .16s var(--ease), background .25s var(--ease), box-shadow .25s var(--ease), border-color .25s var(--ease), color .25s var(--ease), opacity .25s var(--ease) }
    .fx-lift:hover { transform: translateY(-1px) }
    .fx-press:active { transform: translateY(0) scale(.98) }
    .ring:focus-visible { outline: 0; box-shadow: 0 0 0 4px rgba(255,255,255,.14) }
    @media (prefers-reduced-motion: reduce) { .fx-trans { transition: none } }

    /* ===== Botões ===== */
    button, .btn, .ib { background: var(--surface); border: var(--bd); color: var(--fg); font-weight: 800; border-radius: 12px; cursor: pointer; position: relative }
    .btn { padding: .58rem .9rem; background: linear-gradient(180deg, #11162a, #0b1122) }
    .btn.prime { background: linear-gradient(90deg, #a66fff, #6db4ff); color: #0b0f14; border-color: transparent }
    .btn:hover { box-shadow: 0 8px 26px rgba(0,0,0,.36), 0 0 0 1px rgba(255,255,255,.10) inset }
    .btn.prime:hover { box-shadow: 0 10px 30px rgba(166,111,255,.26), 0 0 0 1px rgba(255,255,255,.18) inset }
    .btn:active { filter: saturate(1.02) brightness(.98) }
    .btn[disabled] { opacity: .55; pointer-events: none }

    /* Ripple */
    .ripple { position: absolute; inset: 0; overflow: hidden; border-radius: inherit }
    .ripple > i { position: absolute; border-radius: 999px; pointer-events: none; transform: translate(-50%, -50%); background: radial-gradient(closest-side, rgba(255,255,255,.35), rgba(255,255,255,0) 70%); animation: ripple .6s var(--ease) forwards }
    @keyframes ripple { from { opacity: .55; width: 0; height: 0 } to { opacity: 0; width: 260px; height: 260px } }

    /* ===== Header ===== */
    header.mast { position: relative; inset: 0 0 auto 0; height: var(--hdrH); z-index: 100; display: flex; align-items: center; gap: 10px; padding: 0 12px; backdrop-filter: blur(var(--blur)) saturate(130%); background: linear-gradient(180deg, rgba(0,0,0,.28), rgba(0,0,0,0)); margin-top: var(--hdrOffset); }
    .ib { width: 42px; height: 42px; border-radius: 50%; display: grid; place-items: center; box-shadow: var(--shadow) }
    .ib.fx-trans:hover { box-shadow: 0 10px 28px rgba(0,0,0,.5), 0 0 0 2px rgba(255,255,255,.10) inset }
    .title { flex: 1; text-align: center; line-height: 1 }
    .title h1 { margin: 0; font-size: 18px; letter-spacing: .06em; font-weight: 900 }
    .title small { display: block; color: var(--mut); letter-spacing: .1em }

    /* ===== Layout ===== */
    main { position: relative; height: 100%; padding-top: calc(var(--hdrH) + env(safe-area-inset-top) + var(--hdrOffset)); padding-bottom: calc(var(--tabsH) + env(safe-area-inset-bottom)); overflow: hidden }
    .view { position: absolute; inset: 0; padding: 12px 14px; overflow: auto; display: none }
    .view.active {
      display: block;
      /* Animação de transição mais simples: apenas fade com leve zoom. */
      animation: fadeSimple .6s var(--ease);
    }
    /* Esta animação remove o filtro de blur e utiliza apenas opacidade e escala
       para uma transição mais suave. Você pode ajustar os valores para
       personalizar o timing. */
    @keyframes fadeSimple {
      /* Para um efeito de zoom mais sutil, usamos valores de escala
         mais próximos de 1. Altere estes valores caso deseje ajustar a
         intensidade do zoom. */
      0%   { opacity: 0; transform: scale(0.995); }
      60%  { opacity: 0.8; transform: scale(1.005); }
      100% { opacity: 1; transform: scale(1); }
    }

    /* ===== Cards / grids ===== */
    .grid { display: grid; gap: 12px; max-width: 820px; margin: 0 auto }
    /* Distribua os cartões de status da Home em duas colunas para melhor encaixe.
       Em telas estreitas (<560px) eles se empilham em uma única coluna. */
    .cards { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 12px }
    @media (max-width: 560px) { .cards { grid-template-columns: 1fr } }

    /* Ocultar o menu de opções (Apps, Stack, Brain, Revo) na Home quando apenas a bola dos arquétipos deve aparecer */
    /* Hide the UNO info card on home. The cards row is now used for status notifications */
    #v-home #unoCard {
      display: none;
    }

    /* Esconde a grade de cards na Home e abre espaço para o feed de IA */
    #v-home .cards {
      display: none !important;
    }

    /* O feed de IA na Home foi substituído pelo preview laranja; esconda o feed original */
    #v-home #iaFeed {
      display: none !important;
    }

    /* ===== Estilos para ícones fixados na barra ===== */
    .tabbar .tab[data-pinned] {
      /* Estilo semelhante às abas padrão, mas com cor diferenciada no hover */
      position: relative;
    }
    .pin-letter {
      width: 18px;
      height: 18px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      font-size: 12px;
      font-weight: 800;
      background: rgba(255, 255, 255, 0.15);
      color: var(--fg);
      line-height: 1;
    }

    /* Estiliza o feed de mensagens da IA em formato de conversa */
    #iaFeed {
      margin: 12px auto 0;
      max-width: 820px;
      background: var(--surface);
      border: var(--bd);
      border-radius: var(--r2);
      box-shadow: var(--shadow);
      padding: 12px;
      font-size: 14px;
      line-height: 1.5;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    #iaFeed .msg {
      margin: 0;
      padding: 8px 12px;
      border-radius: 16px;
      max-width: 75%;
      word-wrap: break-word;
    }
    #iaFeed .msg.user {
      align-self: flex-end;
      background: rgba(255,255,255,0.1);
      border-radius: 16px 16px 0 16px;
    }
    #iaFeed .msg.ai {
      align-self: flex-start;
      background: rgba(57,255,182,0.12);
      border-radius: 16px 16px 16px 0;
    }
    #iaFeed .status {
      color: var(--mut);
      font-size: 12px;
      align-self: center;
    }

    /* ===== Apps Page customizations ===== */
    /* Estilizar botão de upload de HTML local para destaque */
    #btnImport {
      font-weight: 700;
      color: var(--ink);
      background: var(--glass);
      border-color: var(--line);
    }
    /* Favorite icon/button dentro de cada cartão de app */
    .app-card {
      position: relative;
    }
    .fav-btn {
      position: absolute;
      top: 6px;
      right: 6px;
      width: 22px;
      height: 22px;
      background: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
      opacity: 0.6;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }
    .fav-btn.fav {
      opacity: 1;
    }
    .fav-btn img {
      width: 100%;
      height: 100%;
      /* Ícones não favoritados ficam em tons de cinza para indicar estado off */
      filter: grayscale(1) brightness(0.5);
    }
    .fav-btn.fav img {
      /* Ícone favoritado mantém cor original (amarelo) */
      filter: none;
    }
    .card { background: var(--surface); border: var(--bd); border-radius: var(--r2); box-shadow: var(--shadow); padding: 12px; display: flex; gap: 10px; align-items: center; position: relative; backdrop-filter: blur(8px) saturate(160%) }
    .card.fx-trans:hover { box-shadow: 0 16px 40px rgba(0,0,0,.5) }
    .ico { width: 44px; height: 44px; border-radius: 14px; display: grid; place-items: center; background: rgba(255,255,255,.06); border: var(--bd) }
    .mut { color: var(--mut); font-size: 12px }
    .input, select, textarea { width: 100%; background: #0f1426; color: var(--fg); border: var(--bd); border-radius: 12px; padding: 10px }

    /* Ajuste para ícones SVG externos: invertê-los para que fiquem claros em temas escuros */
    header.mast img,
    .tabbar img,
    .card .ico img,
    .session .tools img,
    .dock img {
      filter: invert(1) brightness(1.2);
    }

    /* ===== Apps ===== */
.apps-wrap {
      display: grid;
      gap: 12px;
      /* Distribui os apps em colunas responsivas: cada cartão terá no mínimo 240px. */
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      /* Adiciona uma margem inferior generosa para que o dock/tabbar não sobreponha os últimos elementos. */
      padding-bottom: 80px;
    }
.app-card {
      display: flex;
      gap: 12px;
      align-items: center;
      /* Use um fundo com maior opacidade e um leve blur para destacar cada app e melhorar a legibilidade */
      background: var(--surface);
      backdrop-filter: blur(8px) saturate(160%);
      border: var(--bd);
      border-radius: var(--r);
      padding: 14px;
    }
    .app-card:hover { box-shadow: 0 12px 34px rgba(0,0,0,.46) }
    .app-icon { width: 42px; height: 42px; border-radius: 12px; display: grid; place-items: center; background: #0f1528; border: var(--bd); overflow: hidden }

    /* Ícone com a letra do app no cabeçalho das sessões. Utiliza a
       primeira letra do título e cores do gradiente para destacar o
       aplicativo em cada cartão. */
    .session .hdr .app-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 6px;
      background: var(--grad-a);
      color: #fff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
    }
    .app-title {
      font-weight: 800;
      /* Evitar quebra de linhas em títulos longos e mostrar reticências */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    /* Âncora para sessões abertas no topo da página (modo "abrir dentro"). */
    #sessionsAnchor {
      display: grid;
      gap: 12px;
      margin: 12px 14px;
    }
    /* Estilos para o painel Brain (perfil, performance, voz, logs). */
    #brain { position: fixed; top: calc(var(--hdrH) + 12px); right: 14px; width: min(92vw, 440px); z-index: 130; }
    #brain.hide { display: none !important; }
    .popover { border-radius: 24px; padding: 12px; background: var(--surface-strong); border: var(--bd); backdrop-filter: blur(var(--blur)); }
    .menuItem { display: flex; gap: 12px; align-items: center; border: var(--bd); background: var(--surface); border-radius: 16px; padding: 12px; }
    .menuItem + .menuItem { margin-top: 9px; }
    .input { display: flex; gap: 8px; align-items: center; background: var(--surface); border: var(--bd); border-radius: 14px; padding: 9px 11px; }
    .input input, .input select { flex: 1; background: transparent; border: 0; outline: 0; color: var(--fg); font-size: 13px; }
    .notice { font-size: 12px; color: var(--mut); }

    /* ===== Viewer (Stack) ===== */
    .session { background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02)); border: var(--bd); border-radius: 16px; box-shadow: var(--shadow); overflow: hidden }
    .session .hdr { display: flex; align-items: center; gap: 8px; padding: 10px; background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); border-bottom: 1px solid #ffffff18 }
    .session .title { font-weight: 850; max-width: 56vw; white-space: nowrap; overflow: hidden; text-overflow: ellipsis }
    .session .tools { margin-left: auto; display: flex; gap: 6px }
    .session .tools .btn:hover { box-shadow: 0 0 0 1px rgba(255,255,255,.18) inset, 0 8px 22px rgba(0,0,0,.35) }
    .session iframe { display: block; width: 100%; height: 60vh; border: 0; background: #000 }
    .session.min iframe { display: none }

    /* Permite redimensionar a altura do iframe dentro das sessões arrastando o canto inferior esquerdo */
    .session { position: relative; }
    .session .resize-handle {
      position: absolute;
      left: 8px;
      bottom: 8px;
      width: 16px;
      height: 16px;
      cursor: ns-resize;
      border-radius: 4px;
      background: rgba(255,255,255,.15);
      border: 1px solid rgba(255,255,255,.25);
    }
    .session .resize-handle:hover { background: rgba(255,255,255,.25); }

    /* ===== Dock + Tabs ===== */
    .dock { position: fixed; left: 10px; right: 10px; bottom: calc(var(--tabsH) + 8px + env(safe-area-inset-bottom)); display: none; gap: 8px; flex-wrap: wrap; z-index: 80 }
    .badge { display: inline-flex; gap: 6px; align-items: center; padding: .38rem .65rem; border: 1px solid #ffffff18; background: #0f1428; border-radius: 999px; font-weight: 800; position: relative }
    .badge.fx-trans:hover { box-shadow: 0 10px 24px rgba(0,0,0,.5) }
    nav.tabbar { position: fixed; left: 0; right: 0; bottom: env(safe-area-inset-bottom, 0); height: var(--tabsH); z-index: 1500; display: flex; justify-content: center; padding: 6px 14px }
    .tabbar .inner { width: 100%; max-width: 820px; display: flex; justify-content: space-around; align-items: center; background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.14); backdrop-filter: blur(10px); border: var(--bd); border-radius: 22px; box-shadow: var(--shadow); padding: 10px 14px }
    .tab { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px; color: var(--mut); font-size: 11px; font-weight: 800; padding: 8px; border-radius: 14px; cursor: pointer; position: relative }
    .tab.fx-trans:hover { background: rgba(255,255,255,.06) }
    .tab.active { color: var(--fg); background: rgba(255,255,255,.10); box-shadow: 0 0 0 2px rgba(255,255,255,.10) }

    /* === Área de Arquétipos (central circle) === */
    .arch-container {
      /* Organize o círculo e o seletor em coluna.  Alinhe os elementos ao centro
         e adicione um pequeno espaçamento vertical.  A propriedade position
         relative permite posicionar o menu de opções de forma absoluta logo
         abaixo do círculo. */
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      justify-content: center;
      /* Dá mais espaço do topo, relativo à altura da viewport */
      margin-top: 5vh;
    }
    .arch-circle {
      position: relative;
      width: min(80vw, 560px);
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      /* O conteúdo deve permanecer dentro da forma circular para evitar
         que o iframe quadrado “vaze” e pareça um quadrado. */
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.12);
      background: radial-gradient(60% 60% at 50% 50%, rgba(0,255,255,.1), rgba(255,255,255,.02));
      box-shadow: var(--shadow, 0 14px 40px rgba(0,0,0,.45));
      /* Animação de clique: quando a classe .pressed é aplicada via JS, reduza
         levemente o tamanho para simular pressão. */
      transition: transform .18s var(--ease);
    }

    .arch-circle.pressed {
      transform: scale(0.96);
    }

    .arch-circle iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
      /*
       * Defina um plano de fundo escuro para o iframe do arquétipo. Quando um
       * PNG ou outro recurso não estiver disponível ou demora a carregar,
       * alguns navegadores exibem uma cor de fundo branca padrão. Ao
       * especificar explicitamente uma cor escura aqui, evitamos flashes
       * de branco e mantemos a estética coesa durante as transições.
       */
      background: #0b0f14;
    }

    /* ===== Splash overlay ===== */
    /* O elemento #appSplash cobre toda a tela enquanto o app carrega.
       Ele utiliza o loader UNO personalizado definido abaixo. */
    #appSplash {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background: linear-gradient(42deg, var(--grad-a), var(--grad-b));
      z-index: 200;
      opacity: 1;
      visibility: visible;
      transition: opacity .3s var(--ease), visibility 0s linear .3s;
    }
    #appSplash.hidden {
      opacity: 0;
      visibility: hidden;
    }
    /* Crie elementos de fundo difuso atrás do loader para um efeito de luz suave.
       Estes pseudoelementos adicionam manchas coloridas em tons das cores do gradiente,
       ajudando a diferenciar o loader do plano de fundo. */
    #appSplash::before,
    #appSplash::after {
      content: "";
      position: absolute;
      width: 420px;
      height: 420px;
      border-radius: 50%;
      filter: blur(100px);
      opacity: .35;
      pointer-events: none;
    }
    #appSplash::before {
      background: var(--grad-a);
      top: -180px;
      left: -120px;
    }
    #appSplash::after {
      background: var(--grad-b);
      bottom: -180px;
      right: -120px;
    }

    /* ===== Loaders UNO e outros loaders ===== */
    /* Estes estilos são incorporados diretamente para evitar dependência externa. */
    .di{ --di-size:40px; --di-stroke:2px; --di-gold: color-mix(in oklab, var(--grad-a) 60%, var(--grad-b) 40%);
      position:relative;width:var(--di-size);height:var(--di-size); }
    /* Ajuste as cores do anel do loader para maior contraste no splash.
       Utilize um branco semi-transparente para destacá-lo contra o fundo colorido. */
    .di .ring{
      position:absolute;
      inset:0;
      /* Ajuste a opacidade do contorno branco para obter um efeito mais sutil no anel. */
      border:var(--di-stroke) solid rgba(255,255,255,0.35);
      border-radius:50%;
      animation:di-spin 6s linear infinite;
    }
    .di .stroke{position:absolute;left:50%;top:50%;width:62%;height:var(--di-stroke);
      background:linear-gradient(90deg,var(--grad-a),var(--grad-b));transform:translate(-50%,-50%);
      border-radius:999px;animation:di-breathe 2.4s ease-in-out infinite; }
    .di .dots{position:absolute;inset:0;transform:rotate(-90deg);animation:di-orbit 4.2s linear infinite; }
    .di .dots i{--i:0;position:absolute;left:50%;top:50%;width:4px;height:4px;border-radius:50%;
      background:conic-gradient(var(--grad-a),var(--grad-b));
      -webkit-mask: radial-gradient(circle, #000 62%, transparent 63%);
      mask: radial-gradient(circle, #000 62%, transparent 63%);
      opacity:.85;transform:rotate(calc(var(--i)*51deg)) translate(calc(7px + var(--i)*2.2px)) rotate(calc(var(--i)*-51deg));
      animation:di-pulse 4.2s linear infinite;animation-delay:calc(var(--i)*.6s); }
    @keyframes di-orbit{to{transform:rotate(270deg);}}
    @keyframes di-spin{to{transform:rotate(360deg);}}
    @keyframes di-breathe{0%,100%{opacity:.9;}50%{opacity:1;}}
    @keyframes di-pulse{0%,70%{opacity:.55;transform:scale(.92);}76%,84%{opacity:1;transform:scale(1.12);}100%{opacity:.7;transform:scale(.96);}}

    .simbio{position:relative;width:40px;height:40px; }
    .simbio .ringA,.simbio .ringB{position:absolute;inset:0;border-radius:50%;
      -webkit-mask:radial-gradient(farthest-side,transparent calc(50% - 1px),#000 calc(50% - 1px),#000 100%);
      mask:radial-gradient(farthest-side,transparent calc(50% - 1px),#000 calc(50% - 1px),#000 100%); }
    .simbio .ringA{background:conic-gradient(from 0deg,var(--grad-a),transparent 60%);animation:rotA 4.8s linear infinite; }
    .simbio .ringB{background:conic-gradient(from 180deg,var(--grad-b),transparent 60%);animation:rotB 6.2s linear infinite; }
    .simbio .stroke{position:absolute;left:50%;top:50%;width:60%;height:2px;background:linear-gradient(90deg,var(--grad-a),var(--grad-b));
      transform:translate(-50%,-50%);border-radius:999px;opacity:.9; }
    @keyframes rotA{to{transform:rotate(360deg);}}
    @keyframes rotB{to{transform:rotate(-360deg);}}

    .pulse{position:relative;width:40px;height:40px;display:grid;place-items:center; }
    .pulse .dot{width:8px;height:8px;border-radius:50%;background:linear-gradient(90deg,var(--grad-a),var(--grad-b)); }
    .pulse .wave{position:absolute;inset:0;border-radius:50%;animation:wave 2.4s ease-out infinite;opacity:.6; }
    .pulse .wave::before{content:"";position:absolute;inset:0;border-radius:50%;
      background:conic-gradient(var(--grad-a),var(--grad-b));
      -webkit-mask:radial-gradient(farthest-side,transparent calc(50% - 1px),#000 calc(50% - 1px),#000 100%);
      mask:radial-gradient(farthest-side,transparent calc(50% - 1px),#000 calc(50% - 1px),#000 100%); }
    .pulse .wave:nth-child(1){animation-delay:0s;} .pulse .wave:nth-child(2){animation-delay:.7s;} .pulse .wave:nth-child(3){animation-delay:1.4s; }
    @keyframes wave{0%{transform:scale(.5);opacity:.36;}50%{transform:scale(1.4);opacity:.58;}100%{transform:scale(1.35);opacity:.0;}}

    .coblux{position:relative;width:40px;height:40px;filter:drop-shadow(0 0 10px color-mix(in oklab,var(--grad-a) 35%, transparent)) drop-shadow(0 0 14px color-mix(in oklab,var(--grad-b) 25%, transparent)); }
    .coblux .ring{position:absolute;inset:0;border-radius:50%;background:conic-gradient(from 90deg,var(--grad-a),var(--grad-b));
      -webkit-mask:radial-gradient(farthest-side,transparent calc(50% - 1px),#000 calc(50% - 1px),#000 100%);animation:spinFast 2.4s linear infinite; }
    .coblux .trail{position:absolute;left:50%;top:50%;width:4px;height:4px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#fff 0 20%,var(--grad-a) 40%,var(--grad-b) 100%);transform-origin:-12px 0;animation:trail 1.8s linear infinite; }
    @keyframes spinFast{to{transform:rotate(360deg);}}
    @keyframes trail{to{transform:rotate(360deg);}}

    .icon56{position:relative;width:56px;height:56px;display:block; }
    .home-base{position:absolute;left:50%;top:50%;width:36px;height:24px;border:3px solid var(--grad-b);border-top:3px solid transparent;
      transform:translate(-50%,-10px) scale(0);border-radius:5px;box-shadow:0 0 10px color-mix(in oklab,var(--grad-b) 60%, transparent);animation:homeBase 2.4s ease-in-out infinite; }
    .home-roof{position:absolute;left:50%;top:30%;width:0;height:0;border-left:18px solid transparent;border-right:18px solid transparent;border-bottom:20px solid var(--grad-b);
      transform:translateX(-50%) scaleX(0);filter:drop-shadow(0 0 8px color-mix(in oklab,var(--grad-a) 60%, transparent));animation:homeRoof 2.4s ease-in-out infinite; }
    @keyframes homeBase{0%{transform:translate(-50%,-10px) scale(0);}40%{transform:translate(-50%,-10px) scale(1);}80%{transform:translate(-50%,-10px) scale(1);}100%{transform:translate(-50%,-10px) scale(0);}}
    @keyframes homeRoof{0%{transform:translateX(-50%) scaleX(0);}50%{transform:translateX(-50%) scaleX(1);}100%{transform:translateX(-50%) scaleX(0);}}
    .asst-left,.asst-right{position:absolute;left:50%;top:50%;width:26px;height:26px;border-radius:50%;filter:drop-shadow(0 0 6px color-mix(in oklab,var(--grad-a) 50%, transparent)); }
    .asst-left{background:radial-gradient(circle at 50% 35%, var(--grad-b) 38%, transparent 39%), radial-gradient(circle at 50% 90%, var(--grad-b) 32%, transparent 33%);
      transform:translate(-50%,-50%) translateX(0);animation:aL 1.6s ease-in-out infinite; }
    .asst-right{background:radial-gradient(circle at 50% 35%, color-mix(in oklab, var(--grad-a) 70%, #ff7a00) 38%, transparent 39%), radial-gradient(circle at 50% 90%, color-mix(in oklab, var(--grad-a) 70%, #ff7a00) 32%, transparent 33%);
      transform:translate(-50%,-50%) translateX(0);animation:aR 1.6s ease-in-out infinite; }
    @keyframes aL{0%,100%{transform:translate(-50%,-50%) translateX(0) scale(1);}50%{transform:translate(-50%,-50%) translateX(-10px) scale(.95);}}
    @keyframes aR{0%,100%{transform:translate(-50%,-50%) translateX(0) scale(1);}50%{transform:translate(-50%,-50%) translateX(10px) scale(.95);}}
    .kob-ring{position:absolute;inset:6px;border-radius:50%;background:conic-gradient(from 0deg, var(--grad-b) 0 350deg, transparent 350deg 360deg);
      filter:drop-shadow(0 0 8px color-mix(in oklab,var(--grad-a) 60%, transparent));animation:spin 1.2s linear infinite; }
    .kob-spiral{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:22px;animation:spin 1.6s linear infinite reverse;
      filter:drop-shadow(0 0 6px color-mix(in oklab,var(--grad-b) 60%, transparent)); }
    @keyframes spin{to{transform:rotate(360deg);}}

    /* Texto animado no splash */
    #appSplash .loading-text {
      margin-top: 20px;
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 0.04em;
      color: #f8f9fc;
      opacity: 1;
      /* Ajuste a animação para que o texto apareça suavemente,
         tornando-se totalmente visível no meio do ciclo e
         desaparecendo delicadamente. */
      animation: fadeUp 2.4s ease-in-out infinite;
    }
    @keyframes fadeUp {
      0%, 20% { opacity: 0; transform: translateY(12px); }
      40%, 60% { opacity: 1; transform: translateY(0); }
      80%, 100% { opacity: 0; transform: translateY(-12px); }
    }

  /* Certifique-se de que o logotipo de ponto e o círculo de arquétipo
     fiquem sobrepostos ao iframe. O seletor (arch-switcher) é
     configurado separadamente e fica fora do círculo. */
  .arch-dotlogo, .arch-circle {
    position: relative;
    z-index: 60;
  }
    .arch-switcher {
      /* O seletor fica fora do círculo, como um elemento próprio da
         coluna.  Não é posicionado de forma absoluta; sua posição é
         determinada pelo fluxo flex da .arch-container. */
      display: flex;
      gap: 6px;
      align-items: center;
      background: rgba(15,17,32,.7);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 999px;
      padding: 4px 8px;
      backdrop-filter: blur(8px);
      z-index: 70;
    }
    .arch-switcher select {
      appearance: none;
      background: rgba(255,255,255,.06);
      color: var(--fg);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 999px;
      /* Reduzir padding e tamanho de fonte para caber melhor fora do círculo */
      padding: 4px 8px;
      font-size: 12px;
    }

  /* Redimensionar botões do seletor de arquétipos para um tamanho mais compacto */
  .arch-switcher button {
    width: 30px;
    height: 30px;
    padding: 0;
    border-radius: 8px;
  }

    /* Quando o modo áudio está ativo, destaque o círculo com uma borda sutil */
    .arch-circle.audio-on {
      box-shadow: 0 0 0 2px var(--ok), var(--shadow);
    }

    /* Mensagem exibida fora do círculo do arquétipo.  Ela fica abaixo
       da bolinha e utiliza um fundo translúcido para garantir
       legibilidade.  O elemento aparece e desaparece com uma transição
       de opacidade. */
    .arch-msg {
      margin-top: 8px;
      padding: 6px 10px;
      border-radius: 12px;
      background: rgba(15,17,32,.72);
      color: var(--fg);
      font-size: 13px;
      max-width: 90%;
      text-align: center;
      pointer-events: none;
      opacity: 0;
      transition: opacity .3s ease;
    }
    .arch-msg.show { opacity: 1; }

    /* Estilização do menu de arquétipos acionado ao tocar a bola.  O menu
       exibe opções de navegação (Apps, Stack, Usuário, Arquétipo e Revo)
       e fica escondido por padrão.  Quando a classe .show é aplicada,
       ele usa flexbox para alinhar os botões. */
    .arch-menu {
      /* O menu é posicionado de forma absoluta abaixo do círculo.  Por
         padrão, ele fica invisível até que a classe .show seja aplicada.
         A propriedade transform centraliza o menu horizontalmente em
         relação ao contêiner. */
      position: absolute;
      top: calc(100% + 10px);
      left: 50%;
      transform: translateX(-50%);
      display: none;
      gap: 10px;
      z-index: 70;
    }
    .arch-menu.show {
      display: flex;
    }
    .arch-menu button {
      border: var(--bd);
      background: var(--surface);
      border-radius: 12px;
      padding: 6px 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: var(--fg);
      font-size: 10px;
      cursor: pointer;
    }
    .arch-menu button:hover {
      box-shadow: 0 10px 24px rgba(0,0,0,.5);
    }

    /* Quando o botão de áudio está ativado, destaque-o com a cor "ok" */
    .arch-menu button.on {
      background: var(--ok);
      color: var(--surface-strong);
    }
    .arch-menu button.on img {
      filter: none;
    }
    .arch-menu button img {
      width: 20px;
      height: 20px;
      margin-bottom: 2px;
      filter: invert(1) brightness(1.2);
    }
    #arch-fadeCover {
      position: absolute;
      inset: 0;
      /* Use a cor do arquétipo ativo, se definida, para o fade. Isso
         torna a transição mais perceptível quando um novo arquétipo
         é selecionado.  Caso não haja overlay, caia para a cor de
         fundo padrão. */
      background: var(--arch-overlay, var(--bg, #0b0f14));
      opacity: 0;
      pointer-events: none;
      transition: opacity .3s ease;
    }
    #arch-fadeCover.show { opacity: 1; }

    /* Camada para ripples de áudio: fica sobre o conteúdo do círculo e ajusta a opacidade
       conforme a intensidade capturada pelo microfone. Utilizamos mix-blend-mode
       para adicionar um brilho sutil sem quebrar a estética minimalista. */
    .audio-ripple {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      /* A camada de ripple agora serve também como área de clique para ativar o modo áudio. */
      pointer-events: auto;
      /* Retire o gradiente, pois o efeito visual passa a ser aplicado via box-shadow no círculo */
      background: transparent;
      /* Mantenha um z-index alto para captar cliques acima do iframe */
      z-index: 70;
    }

    /* ===== Modal ===== */
    .modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; z-index: 120; background: rgba(0,0,0,.45); backdrop-filter: blur(6px) }
    .modal.open { display: flex }
    .modal .panel { width: min(720px, 92vw); background: var(--surface-strong); border: var(--bd); border-radius: 16px; box-shadow: var(--shadow); padding: 16px }
    .kbd { border: 1px solid rgba(255,255,255,.2); background: rgba(255,255,255,.06); padding: 2px 6px; border-radius: 6px; font-family: ui-monospace, Menlo, Consolas, monospace; font-size: 12px }

    /* ===== Chat (Dual • Chat) ===== */
    /* Configuração da seção de chat */
    #v-chat {
      padding: 0;
      /* Não defina display aqui; ele será controlado pela classe .view e .active */
      flex-direction: column;
      gap: 12px;
    }

    /* Certifique-se de que a seção de chat seja exibida somente quando ativa.
       A classe .view define display:none; quando .active é adicionada, tornamos flex para layout vertical. */
    #v-chat.view.active, #v-chat.active {
      display: flex;
    }
    #chatFeed {
      /* Mantenha um tamanho mínimo para que mensagens apareçam mesmo sem altura flex */
      min-height: 120px;
      overflow-y: auto;
      max-height: 46svh;
      background: var(--surface);
      border: var(--bd);
      border-radius: var(--r2);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    #chatFeed .msg {
      max-width: 75%;
      margin: 0;
      padding: 8px 12px;
      border-radius: 16px;
      word-wrap: break-word;
    }
    #chatFeed .msg.user {
      align-self: flex-end;
      background: rgba(255,255,255,0.10);
      border-radius: 16px 16px 0 16px;
    }
    #chatFeed .msg.ai {
      align-self: flex-start;
      background: rgba(57,255,182,0.12);
      border-radius: 16px 16px 16px 0;
    }
    #chatFeed .msg.status {
      align-self: center;
      color: var(--mut);
      font-size: 12px;
    }
    /* O formulário #chatForm e o campo #chatInput foram removidos.  O envio
       de mensagens é feito exclusivamente pelo overlay de texto fixo. */
    #msgPreview {
      position: fixed;
      left: 14px;
      right: 14px;
      bottom: calc(var(--tabsH) + 20px + env(safe-area-inset-bottom, 0));
      background: var(--warn);
      color: #0b0f14;
      border-radius: 18px;
      padding: 10px 14px;
      font-weight: 800;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      box-shadow: var(--shadow);
      z-index: 95;
      cursor: pointer;
      display: none;
  /* Limite de altura para o preview; evita estourar o layout e permite arrastar no chat */
  max-height: 33px;
  overflow: hidden;
    }
    /* Ajuste para preview quando nav está na lateral direita */
    body.nav-right #msgPreview {
      right: calc(88px + 14px);
      bottom: 14px;
    }

    /* ===== Overlay de entrada rápida na Home ===== */
    /* Removido: o botão #homeInputToggle não é mais utilizado; os controles
       de texto/voz são representados pelas bolinhas de ação. */
    #homeInputOverlay {
      position: fixed;
      left: 14px;
      right: 14px;
      bottom: calc(var(--tabsH) + env(safe-area-inset-bottom, 0));
      background: var(--surface-strong);
      border-radius: 18px 18px 0 0;
      border: var(--bd);
      padding: 12px;
      box-shadow: var(--shadow);
      z-index: 97;
      display: none;
    }
    #homeInputOverlay form {
      display: flex;
      gap: 8px;
    }
    #homeInputOverlay input {
      flex: 1;
      background: #0f1426;
      color: var(--fg);
      border: var(--bd);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 18px;
    }
    #homeInputOverlay input::placeholder {
      color: var(--mut);
    }
    #homeInputOverlay button {
      background: var(--ok);
      border: none;
      border-radius: 12px;
      padding: 0 16px;
      color: #0b0f14;
      font-weight: 700;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    /* Ajustes quando a navegação está na direita: reposicione o botão e overlay para não colidir com a barra */
    /* body.nav-right #homeInputToggle removido */
    body.nav-right #homeInputOverlay {
      left: 14px;
      right: calc(88px + 14px);
      bottom: calc(14px + env(safe-area-inset-bottom, 0));
    }

    /* ===== Botões duplos (texto/voz) na Home ===== */
    /* Variante lateral empilhada: os botões ficam no canto direito,
       empilhados um sobre o outro (coluna) para indicar ações distintas
       (texto e voz).  Ajustamos a posição para cima da barra de
       navegação. */
    .home-btns {
      position: fixed;
      right: 14px;
      left: auto;
      transform: none;
      bottom: calc(var(--tabsH) + 30px + env(safe-area-inset-bottom, 0));
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 10px;
      z-index: 97;
    }
    .home-btn {
      width: 42px;
      height: 42px;
      border-radius: 21px;
      background: var(--surface);
      border: var(--bd);
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    .home-btn img {
      width: 20px;
      height: 20px;
    }
    .home-btn.active {
      background: var(--ok);
      color: #0b0f14;
    }
    /* Layout da barra de abas no modo nav-right */
    body.nav-right nav.tabbar {
      left: auto;
      right: 0;
      top: var(--hdrH);
      bottom: env(safe-area-inset-bottom, 0);
      width: 78px;
      height: auto;
      display: flex;
      justify-content: flex-start;
      padding: 6px 6px;
    }
    body.nav-right .tabbar .inner {
      width: 100%;
      max-width: none;
      flex-direction: column;
      align-items: center;
    }
    body.nav-right .tab {
      flex: none;
      width: 100%;
      margin: 4px 0;
    }
    body.nav-right main {
      padding-right: calc(78px + 14px);
      padding-bottom: calc(env(safe-area-inset-bottom, 0) + 12px);
    }
    /* ===== Estilos adicionais para grupos de sessões e fullscreen no Stack ===== */
    /* Container do grupo de sessões. Utiliza <details> para permitir colapsar/expandir. */
    .stack-group { margin-top: 12px; border: var(--bd); border-radius: var(--r); overflow: hidden; }
    .stack-group summary { background: var(--surface); padding: 8px 12px; font-weight: 800; cursor: pointer; list-style: none; display:flex; align-items:center; justify-content:space-between; }
    .stack-group summary::-webkit-details-marker { display: none; }
    .stack-group .group-content { padding: 8px 12px; }
    .stack-group .group-content .session { margin-top: 8px; }

    /* Deixe espaço no fim do Stack para a barra de navegação.  Isso evita que
       as sessões sobreponham os botões da nav inferior. */
    #stackWrap {
      padding-bottom: calc(var(--tabsH) + 16px);
    }

    /* Tela cheia de uma sessão: ocupa toda a tela, esconde cabeçalho e tabs */
    .session.full { position: fixed !important; inset: 0; z-index: 1000; margin: 0; width: 100%; height: 100%; display: flex; flex-direction: column; }
    .session.full iframe { flex: 1 1 auto !important; height: 100% !important; }
    /* No modo de tela cheia, esconda apenas o cabeçalho e o botão flutuante, mas mantenha a barra de navegação visível. */
    body.session-full header.mast,
    body.session-full .tabs-wrap,
    body.session-full .fab { display: none !important; }



/* === ORB + Particles (escopado dentro do círculo de arquétipos) === */
.arch-circle .orb-wrap{
  pointer-events:auto;
  position:absolute;
  inset: 6%;
  width: 88%;
  height: 88%;
  display:grid;
  place-items:center;
  border-radius:50%;
  filter: drop-shadow(0 24px 48px rgba(0,0,0,.45));
  z-index: 5; /* acima do iframe, abaixo de overlays de UI */
}
.arch-circle canvas#orb, .arch-circle canvas#particles{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border-radius:50%;
  display:block;
  pointer-events:none; /* não bloquear cliques do hub */
}
.arch-circle .orb-glow{
  position:absolute;
  inset:-8%;
  border-radius:50%;
  pointer-events:none;
  background:radial-gradient(60% 60% at 50% 50%, rgba(122,60,255,.18), rgba(0,229,255,.14) 45%, rgba(0,0,0,0) 70%);
  filter:blur(16px);
  opacity:.92;
  transition:opacity .6s ease, transform .6s ease;
}
.arch-circle .orb-wrap.activated .orb-glow{ transform:scale(1.05); }
.arch-circle .ring{
  position:absolute;
  inset:-8%;
  border-radius:50%;
  pointer-events:none;
  background: radial-gradient(80% 80% at 50% 50%, rgba(255,255,255,.10), rgba(255,255,255,0) 42%);
}
.arch-circle .call{
  position:absolute;
  bottom: 12px;
  left: 50%;
  transform: translateX(-50%);
  color: rgba(234,242,255,.78);
  font-size: 11px;
  letter-spacing: .3px;
  text-align: center;
  white-space: nowrap;
  pointer-events: none;
  opacity: .85;
  text-shadow: 0 1px 0 rgba(0,0,0,.5);
}
@media (min-width:768px){
  .arch-circle .call{ font-size:12px; }
}



/* === Blue‑1 Theme (UI) === */
:root {
  --bg: #070b12;
  --fg: #e6f2ff;
  --muted: #94b6d6;
  --brandA: #00c2ff;
  --brandB: #4b6fff;
  --brandHi: #8fd3ff;
  --glass: rgba(12,16,24,.64);
  --glass-2: rgba(12,16,24,.42);
  --ring: 0 0 0 1px rgba(143,211,255,.3), 0 0 18px rgba(0,194,255,.25);
}
body { background: radial-gradient(1200px 800px at 60% -10%, #0a1220 0%, #070b12 55%, #05080f 100%); color: var(--fg); }
.topbar, .subbar, .dock, .pane, .card, .tile, .shelf { background: var(--glass); backdrop-filter: blur(10px); border: 1px solid rgba(143,211,255,.12); box-shadow: var(--ring); }
button, .btn, .chip { background: linear-gradient(180deg, rgba(13,22,34,.7), rgba(9,14,22,.7)); border: 1px solid rgba(143,211,255,.18); }
a { color: var(--brandHi); }


/* --------------------------------------------
   KOBLLUX • Compact Mode — Mobile-first Vertical
   Colar após o CSS atual
--------------------------------------------- */

/* Base compacta + segurança */
*,
*::before,
*::after { box-sizing: border-box; }
html, body { max-width: 100%; overflow-x: hidden; }
body { padding-bottom: calc(16px + env(safe-area-inset-bottom)); }

/* Container nunca estoura, sem “gambiarra” de largura */
.response-container {
  inline-size: min(100%, calc(100% - 0px)) !important;
  padding: 1rem 0 2.75rem; /* + espaço safe-area já no body */
}

/* Nada lado a lado por padrão — empilha tudo */
.row,
.controls,
.kv,
.columns,
.split {
  display: block !important;
}

/* Qualquer tentativa de grid vira 1 coluna */
[class*="grid"],
[style*="grid-template-columns"],
.columns,
.split,
.panel,
.kv {
  display: grid !important;
  grid-template-columns: 1fr !important;
  align-items: stretch;
  gap: .5rem !important;
}

/* Pares “key→value” agora empilhados */
.kv > * { margin: 0 0 .4rem 0; }

/* Grupos de controles em coluna, ocupando 100% */
.controls .group {
  display: block !important;
  width: 100%;
  padding: .5rem .6rem;
  margin: 0 0 .6rem 0;
}
.controls .group > label,
.controls .group > select,
.controls .group > input,
.controls .group > button { display: block; width: 100%; }

/* Botões e inputs: alvo de toque ≥44px */
.btn,
select,
input[type="text"],
input[type="file"],
input[type="range"],
input[type="checkbox"],
input[type="radio"],
label[for],
textarea {
  min-height: 44px;
}

/* Botão Único: respeita safe-area no iOS */
#btnKOBLLUX { 
  bottom: calc(1rem + env(safe-area-inset-bottom));
}

/* Navegações/chips SOMENTE na header: scroll horizontal, sem wrap */
.header .row {
  display: block !important;
  overflow-x: auto;
  white-space: nowrap;
  scrollbar-width: thin;
  -webkit-overflow-scrolling: touch;
  padding-bottom: .25rem;
  margin-bottom: .25rem;
}
.header .row > * {
  display: inline-block;
  vertical-align: top;
  margin-right: .5rem;
}

/* Dropzone 100% vertical */
.dropzone .dz-area { display: block !important; }
.dropzone .row { display: block !important; }
.dropzone .row > * { display: block; width: 100%; margin: .5rem 0 0; }

/* Editor e Preview sempre empilhados (Preview abaixo)
   Use #analysis como Preview, ou crie #preview se preferir. */
.editor {
  width: 100%;
  min-height: 48vh;
  height: 52vh;          /* alvo ~50–60vh */
  max-height: 60vh;
  overflow: auto;
}
#analysis,
#preview {
  display: block;
  width: 100%;
  min-height: 42vh;
  height: 50vh;          /* alvo ~50–60vh */
  max-height: 60vh;
  overflow: auto;
  white-space: pre-wrap;  /* evita overflow lateral */
  word-wrap: break-word;
}

/* Cards/listas/painéis: pilha vertical com scroll interno quando necessário */
.response-block.glass,
.panel {
  max-height: unset;     /* deixe rolar a página */
}
.panel[data-scroll],
.response-block.glass[data-scroll],
.card[data-scroll],
[list][data-scroll] {
  max-height: 60vh;
  overflow: auto;
}

/* Controles verticais: sliders + labels exibidos em coluna */
.controls label { margin: 0 0 .25rem 0; }
.controls input[type="range"] { margin: .25rem 0 .5rem; }

/* Sliders com preenchimento dinâmico (mantém seu gradiente) */
input[type="range"]{
  /* estes tokens são calculados por JS no seu app, mantidos aqui */
  inline-size: 100%;
}

/* Toggle (Auto‑detectar): aumenta para tap ≥44px */
#autoDetect{
  --w: 72px; --h: 44px; --pad: 4px;
  min-height: 44px;
}

/* SELECT e BTN ocupam a linha inteira no modo compact */
select,
.btn { width: 100%; }

/* Grids/tabelas internas que insistem em múltiplas colunas → força 1fr */
[role="grid"],
[role="table"],
table,
.table,
.list,
.cards,
.cards-grid,
.items-grid {
  display: grid !important;
  grid-template-columns: 1fr !important;
}

/* Editor/Preview evitando sangrar lateralmente (longas strings/URLs) */
.editor,
pre { word-break: break-word; }

/* Header único (nenhum footer fixo) — nenhuma regra extra de footer */

/* Safe-area e “tap spacing” no rodapé de ações flutuantes/badges */
.badge-reopen { 
  bottom: calc(1rem + env(safe-area-inset-bottom));
}

/* Animação e sombras mais discretas (versão compact) */
.glass { padding: .75rem .9rem; }
.btn { padding: .7rem 1rem; }

/* Scroll horizontal utilitário (caso queira aplicar em outra nav) */
.h-scroll { overflow-x: auto; white-space: nowrap; }
.h-scroll > * { display: inline-block; }

/* Qualquer .columns e .split SEMPRE block (reforço final) */
.columns, .split { display: block !important; }

/* Segurança extra: força colunas únicas em componentes “teimosos” */
[class*="columns-"],
[class*="cols-"],
[class*="grid-"] {
  grid-template-columns: 1fr !important;
}

/* Evitar wrap de ícones/textos em chips sem quebrar layout */
.pill { display: inline-block; }

/* Garantir que iFrame seguro não crie overflow lateral */
.ifr { inline-size: 100%; max-inline-size: 100%; }
.ifr .bar { display: block; }
.ifr .bar .spacer { display: none; }
.ifr .bar .btn,
.ifr .bar .btn.ghost { width: 100%; margin-top: .4rem; }

/* Acessibilidade: foco visível “compact” */
:focus-visible { outline: none; box-shadow: 0 0 0 3px rgba(57,255,182,.18); }

/* Restrições finais — nada lado a lado fora da header */
main .row { display: block !important; }
main .row > * + * { margin-top: .5rem; }

/* (Opcional) reduz micro gaps gerais para versão compacta */
.stack { gap: .5rem !important; }
:root{--radius:12px;--blur:16px;--shadow:0 6px 26px rgba(0,255,255,.22);--fast:.12s;--med:.2s;--slow:.45s;--focus-ring:0 0 0 3px rgba(57,255,182,.22);font-synthesis-weight:none}html,body{overflow-x:hidden}body{padding-bottom:max(12px,env(safe-area-inset-bottom))}.response-container{width:min(100%,100% - 0px)!important;padding:1rem 0 4rem}.glass{border-radius:var(--radius);backdrop-filter:blur(var(--blur));box-shadow:var(--shadow);transition:box-shadow var(--med) ease,filter var(--med) ease,transform var(--med) ease}.glass:hover{filter:brightness(1.02)}.row,.controls,.controls .group,.kv,.panel,.stack,.dropzone .dz-area,.header,.sheet,.ifr,.ifr .bar{display:block!important}.row>*,.controls>*,.controls .group>*,.panel>*{margin-block:.55rem}.columns,.split{display:block!important}.header,.panel,.kv,.stack,[class*="grid"],[style*="grid-template-columns"]{grid-template-columns:1fr!important}.editor{min-height:52svh;max-height:60svh;width:100%;resize:vertical;overflow:auto}.preview,#preview{display:block;margin-top:.8rem;min-height:48svh;max-height:58svh;overflow:auto}.header .row.small{display:flex!important;flex-direction:row;flex-wrap:nowrap!important;gap:.5rem;overflow-x:auto;overflow-y:hidden;white-space:nowrap;-webkit-overflow-scrolling:touch;scroll-snap-type:x proximity}.header .row.small>*{flex:0 0 auto;scroll-snap-align:start}:where(button,.btn,[role="button"],label,select,input,textarea,.pill){min-block-size:44px;touch-action:manipulation;-webkit-tap-highlight-color:rgba(255,255,255,.08)}.btn{width:100%;justify-content:center;text-align:center;transition:transform var(--fast) ease,filter var(--fast) ease,box-shadow var(--fast) ease!important}.btn:active{transform:translateY(1px) scale(.995)}#btnKOBLLUX{bottom:calc(1rem + env(safe-area-inset-bottom))}select,.select,textarea,input[type="text"],input[type="email"],input[type="search"],input[type="number"]{width:100%;max-width:100%}input[type="range"]{width:100%!important;min-block-size:44px}.card,.list,.grid,.panel,.sheet,.overlay .sheet,.ifr{max-height:86svh;overflow:auto}footer{position:static!important;inset:auto!important}.header .title{font-weight:700;letter-spacing:.2px}.kv{display:block!important}.kv .muted,.kv .val{display:block}.controls .group{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.08);padding:.6rem .7rem}.pill{padding:.44rem .66rem}.meter{width:100%}.ifr{grid-template-rows:auto 1fr!important}.ifr .bar>*{margin-block:.4rem}@media (prefers-reduced-motion:reduce){*{animation-duration:.001ms!important;animation-iteration-count:1!important;transition-duration:.001ms!important;scroll-behavior:auto!important}}


  #chatFeed .msg.horus{align-self:flex-start;background:rgba(255,195,0,.16);border-radius:16px 16px 16px 0;padding:8px 12px;max-width:75%}
  #chatFeed .msg.atlas{align-self:flex-start;background:rgba(64,158,255,.16);border-radius:16px 16px 16px 0;padding:8px 12px;max-width:75%}
  #chatFeed .msg.ion{align-self:flex-start;background:rgba(255,159,67,.16);border-radius:16px 16px 16px 0;padding:8px 12px;max-width:75%}
  #chatFeed .msg.status{align-self:center;color:var(--mut);background:transparent}
  .ai-tag{font-weight:900;letter-spacing:.02em;margin:0 0 4px 0;opacity:.9}
  .ai-meta{font-size:12px;color:var(--mut)}
  .plan-list{margin:6px 0 0 0;padding-left:18px}
  .plan-list li{margin:4px 0}
  



/* === PATCH • Blue‑1 UI theme (entire UI) === */
body[data-theme="blue1"] {
  --grad-a: #0b1e3b;
  --grad-b: #113a7b;
  --fg: #e8f0ff;
  --mut: rgba(232,240,255,.68);
  --surface: rgba(10,16,28,.55);
  --surface-strong: rgba(10,16,28,.88);
  --bd: 1px solid rgba(126,170,255,.16);
  --ok: #39ffb6;
  --warn: #ffb86b;
  --err: #ff6b6b;
  --blur: 28px;
}
/* Chat styling tuned to Blue‑1 */
body[data-theme="blue1"] #chatFeed .msg.ai { background: rgba(77, 148, 255, 0.14); }
body[data-theme="blue1"] #chatFeed .msg.user { background: rgba(232,240,255,0.10); }




:root{
  --arch-color: #8a2be2;
  --arch-overlay-strength: 12%; /* −1 default */
  --arch-overlay: color-mix(in srgb, var(--arch-color) var(--arch-overlay-strength), transparent);
}
body::after{content:'';position:fixed;inset:0;background:var(--arch-overlay, transparent)!important;pointer-events:none;z-index:0}
#arch-fadeCover{background:var(--arch-overlay, transparent);z-index:2}



#lsModal.ls-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:1200;background:rgba(0,0,0,.55);backdrop-filter:blur(8px)}
#lsModal.ls-modal.open{display:flex}
#lsModal .ls-panel{width:min(1040px,95vw);max-height:86vh;overflow:auto;background:rgba(15,17,32,.92);border:1px solid rgba(255,255,255,.12);border-radius:18px;box-shadow:0 12px 34px rgba(0,0,0,.4);padding:14px;color:#f5f7ff;font:14px/1.45 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial}
#lsModal .ls-hdr{display:flex;gap:10px;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.12);padding-bottom:10px;margin-bottom:10px}
#lsModal .ls-ttl{font-weight:900;letter-spacing:.06em}
#lsModal .ls-actions{display:flex;gap:8px;flex-wrap:wrap}
#lsModal button{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);color:#fff;padding:8px 12px;border-radius:10px;cursor:pointer}
#lsModal button:hover{background:rgba(255,255,255,.18)}
#lsModal .meta{color:#cfd8dc;font-size:12px;margin:8px 0 10px}
#lsModal .presets{border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:8px;background:rgba(255,255,255,.04);margin:10px 0}
#lsModal .presets-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:10px;margin-top:8px}
#lsModal .preset{border:1px solid rgba(255,255,255,.12);border-radius:12px;background:rgba(255,255,255,.04);padding:10px;display:grid;gap:6px}
#lsModal .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
#lsModal .val{font:12px/1.4 ui-monospace,monospace;background:#0b0f1a;border:1px solid rgba(255,255,255,.12);border-radius:10px;padding:8px;max-height:140px;overflow:auto;word-break:break-word}
#lsModal .list{display:grid;gap:10px}
#lsModal .item{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:10px;display:grid;gap:8px}
#lsModal .item .head{display:flex;align-items:center;justify-content:space-between;gap:8px}
#lsModal .key{font-weight:800;max-width:56vw;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
#lsModal .type{font-size:11px;color:#cfd8dc}
#lsModal .switch{inline-size:46px;block-size:28px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.15);position:relative;cursor:pointer}
#lsModal .switch::after{content:"";position:absolute;inset:4px auto 4px 4px;width:20px;border-radius:999px;background:#fff;transition:all .18s}
#lsModal .switch.on{background:rgba(25,226,123,.28)}
#lsModal .switch.on::after{left:22px}
#lsModal .img-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px}
#lsModal .img-card{border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);border-radius:10px;padding:8px}
#lsModal .img-card img{width:100%;height:auto;display:block;border-radius:8px}
#lsModal .sk-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media (max-width:720px){#lsModal .sk-grid{grid-template-columns:1fr}#lsModal .key{max-width:46vw}}
#lsModal .sk-item{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:10px;display:grid;gap:8px}
#lsModal .sk-item .top{display:flex;align-items:center;justify-content:space-between;gap:8px}
#lsModal .sk-item .name{font-weight:800}
#lsModal .sk-item .key{font:12px/1.4 ui-monospace,monospace;opacity:.85;word-break:break-all}
#lsModal .sk-item button{font-size:.75rem;padding:4px 8px;border-radius:8px}
#lsModal .sk-item button:first-child{background:rgba(57,255,182,.18)}
#lsModal .sk-item button:last-child{background:rgba(255,92,138,.18)}
/* inside LS overlay ctl */
#lsModal .seg{display:inline-grid;grid-auto-flow:column;gap:6px}
#lsModal .ls-ov{min-width:40px;padding:6px 8px;border-radius:10px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.08);color:#fff;cursor:pointer;font-weight:700}
#lsModal .ls-ov.on{background:rgba(57,255,182,.20);border-color:rgba(57,255,182,.45)}


.app-title{display:inline-flex;align-items:center;gap:6px}


/* Ensure overlay rendering is unified across variants */
body::after{
  content: "";
  position: fixed;
  inset: 0;
  background: var(--arch-overlay, transparent) !important;
  pointer-events: none;
  z-index: 0;
}



html[data-overlay="off"] body::after{ background: transparent !important; }
html[data-overlay="off"] #arch-fadeCover{ background: transparent !important; }



/* === ORB Slot (iframe "dentro" do orbe) === */
.arch-circle { position: relative; }
#orbWrap { position: relative; }
#orbWrap canvas#orb,
#orbWrap .orb-glow,
#orbWrap .ring,
#orbWrap canvas#particles { position: absolute; inset: 0; }

/* Z-order for sandwiching */
#orbWrap canvas#orb { z-index: 1; }
#orbWrap .orb-glow { z-index: 2; }
#orbWrap .orb-slot   { z-index: 3; } /* iframe masked */
#orbWrap canvas#particles { z-index: 4; }
#orbWrap .ring { z-index: 5; }
/* HUB overlays keep above */
#arch-fadeCover, #audioRipple { z-index: 6; }

/* Masked slot inside the orb */
.orb-slot{
  position:absolute;
  inset: 8%;              /* adjust 6–10% to taste */
  border-radius: 50%;
  overflow: hidden;
  -webkit-clip-path: circle(50% at 50% 50%);
          clip-path: circle(50% at 50% 50%);
  mix-blend-mode: screen;
  opacity: .92;
  filter: saturate(1.06) contrast(1.04);
  will-change: transform, opacity, filter;
  pointer-events: auto;   /* allow interaction inside the archetype app */
}
.orb-slot iframe#arch-frame{
  position:absolute; inset:0;
  width:100%; height:100%;
  border:0; background:#0b0f14; /* avoid white flash */
  transform: translateZ(0);
}
/* Tint with archetype overlay color */
.orb-slot::after{
  content:"";
  position:absolute; inset:0;
  background: var(--arch-overlay, transparent);
  pointer-events:none;
  mix-blend-mode: overlay;
  opacity:.35;
  transition: opacity .25s ease;
}




/* === HD•PRO Override (Dual UNO) ==============================
   - Handle (quase invisível) para abrir/fechar LS Panel (#brain)
   - Painel "HD Pro" dentro do LS Panel (estatísticas + ações)
   - Metrificadores animados de Storage (LocalStorage/IndexedDB/Total)
   - Toggle para colapsar opções avançadas do ORB/FPS
   ================================================================= */
:root{
  --hdpro-glass: rgba(12,16,24,.64);
  --hdpro-line: 1px solid rgba(143,211,255,.14);
  --hdpro-ok: var(--ok, #39ffb6);
  --hdpro-warn: var(--warn, #ffb86b);
  --hdpro-err: var(--err, #ff6b6b);
}

/* Botão/área de pega "tango" (quase invisível) */
#lsHandle{
  position: fixed;
  top: calc(env(safe-area-inset-top, 8px) + 6px);
  left: 8px;
  width: 16px;
  height: 16px;
  border-radius: 999px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.18);
  box-shadow: 0 8px 20px rgba(0,0,0,.45);
  opacity: .14;
  z-index: 1600;
  transition: opacity .18s ease, transform .18s ease, background .18s ease;
  backdrop-filter: blur(6px);
}
#lsHandle:hover, #lsHandle:active{ opacity:.42; transform: scale(1.06); }
#lsHandle.on{ opacity:.8; background: rgba(57,255,182,.25); }

/* Painel HD Pro embutido no LS (#brain .popover) */
.hdpro-sec{
  margin-top: 10px;
  padding: 10px;
  border-radius: 16px;
  background: var(--hdpro-glass);
  border: var(--hdpro-line);
  box-shadow: 0 10px 24px rgba(0,0,0,.35);
}
.hdpro-sec .sec-hdr{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; margin-bottom:8px;
}
.hdpro-sec .sec-hdr h3{
  margin:0; font-weight:900; font-size:14px; letter-spacing:.04em;
}
.hdpro-grid{
  display:grid; grid-template-columns: 1fr; gap:10px;
}
.hdpro-row{ display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center; }
.hdpro-actions{ display:flex; gap:8px; flex-wrap:wrap; }

/* Meters */
.hdpro-meter{
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 10px;
  overflow: hidden;
  height: 14px;
  position: relative;
}
.hdpro-meter .bar{
  position:absolute; left:0; top:0; height:100%;
  width:0%;
  background: linear-gradient(90deg, var(--grad-a), var(--grad-b));
  transition: width .8s cubic-bezier(.22,.61,.36,1);
  box-shadow: inset 0 0 12px rgba(0,0,0,.25);
}
.hdpro-label{ font-size:12px; color: var(--mut, rgba(245,247,255,.68)); }
.hdpro-val{ font-size:12px; font-weight:800; }

/* Toggle de avançados ORB/FPS */
.hdpro-toggle{
  display:flex; align-items:center; gap:8px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 12px; padding: 8px 10px;
  font-size:12px; font-weight:800;
  cursor:pointer;
}
.hdpro-adv-hidden{ display:none !important; }

/* Botões compactos coerentes com tema */
.hd-btn{ 
  background: linear-gradient(180deg, rgba(13,22,34,.7), rgba(9,14,22,.7));
  border: 1px solid rgba(143,211,255,.18);
  color: var(--fg);
  border-radius: 12px; padding: 8px 10px; font-weight:800;
}
.hd-btn.danger{ border-color: rgba(255,107,107,.35); }
.hd-btn.ok{ border-color: rgba(57,255,182,.35); }

/* Toast simples */
#hdToast{
  position: fixed; left: 50%; transform: translateX(-50%);
  bottom: calc(14px + env(safe-area-inset-bottom, 0));
  background: rgba(12,16,24,.92);
  border: 1px solid rgba(255,255,255,.18);
  color: var(--fg);
  border-radius: 14px; padding: 10px 14px;
  font-weight:800; font-size:12px;
  box-shadow: 0 14px 40px rgba(0,0,0,.45);
  z-index: 1700; opacity: 0; pointer-events: none;
  transition: opacity .25s ease, transform .25s ease;
}
#hdToast.show{ opacity: 1; transform: translateX(-50%) translateY(-4px); }




/* Gradient icon tuning (Send/Voice/Text) */
#homeInputOverlay button svg, #homeVoiceBtn svg, #homeTextBtn svg{
  display:block;
}




/* Tabbar gradient tune */
.tabbar .tab { color: var(--muted); }
.tabbar .tab.active { color: var(--fg); }
.tabbar .tab svg { display:block; margin: 0 auto 2px; }




/* Inline gradient icons — unify sizing/alignment */
button svg, .tabbar .tab svg { display:block; }




/* 1) círculo real, tudo recortado */
.arch-circle{
  border-radius: 50% !important;
  overflow: hidden !important;
  isolation: isolate; /* blenda só dentro do círculo */
}

/* 2) pseudo-elements sempre circulares + sem clique */
.arch-circle::before,
.arch-circle::after{
  content:"";
  position:absolute; inset:0;
  border-radius: inherit;
  pointer-events: none;
}

/* 3) tinta com fade radial (sem quadrado) */
.arch-circle::after{
  z-index: 6;
  background: radial-gradient(circle at 50% 50%,
              var(--arch-overlay, rgba(64,158,255,.22)) 62%,
              rgba(64,158,255,0) 86%);
  mix-blend-mode: overlay;
  opacity: .35; /* se quiser mais forte: .5 ~ .6 */
  transition: opacity var(--arch-switch-fade, 120ms) ease;
}

/* 4) véu só durante a troca (evita flash) */
html.arch-switching .arch-circle::after{ opacity: 0; }
.arch-circle::before{
  z-index: 7; opacity: 0;
  transition: opacity var(--arch-switch-fade, 120ms) ease;
}
html.arch-switching .arch-circle::before{
  opacity: 1;
  background: radial-gradient(circle at 50% 50%,
              var(--arch-veil-core, rgba(12,14,24,.88)) 62%,
              rgba(12,14,24,0) 86%);
}

/* 5) canvas do átomo fica sob o overlay e clippado ao círculo */
.arch-circle > canvas#atomCanvas{
  position:absolute; inset:0; pointer-events:none;
  z-index: 5; /* abaixo do ::after(6) e ::before(7) */
  opacity:.88; mix-blend-mode:screen; filter:saturate(120%) contrast(110%);
}

/* 6) botões por cima e clicáveis */
.arch-circle .arch-nav,
.arch-circle [data-arch-nav],
.arch-circle .arch-controls,
.arch-circle .arch-controls *,
.arch-nav, .arch-nav *,
[data-arch-nav], [data-arch-nav] *,
#arch-next, #arch-prev, #archetypeNext, #archetypePrev,
.btn-arch-next, .btn-arch-prev, .arrow-arch-next, .arrow-arch-prev{
  position: relative;
  z-index: 30 !important;
  pointer-events: auto !important;
}



/* Mantém o overlay sempre no background (atrás de tudo). */
body::after{ content:none !important; }
/* Overlay como camada de background (1ª), gradiente Nebula/Blue atrás dela (2ª). */
body{
  background:
    radial-gradient(120% 120% at 50% 40%,
      var(--arch-overlay, rgba(0,0,0,0)) 0%,
      rgba(0,0,0,0) 62%),
    linear-gradient(42deg, var(--grad-a), var(--grad-b)) fixed !important;
}



.chat-wrap{display:grid;gap:12px}
.chat-pulse{position:relative;height:10px;border-radius:999px;
  background:linear-gradient(90deg,var(--grad-a),var(--grad-b));opacity:.8;overflow:hidden}
.chat-pulse::after{content:"";position:absolute;inset:0;
  background:radial-gradient(60% 120% at 0% 50%, #fff8 0%, #fff0 60%);
  animation:pulseRun 2.8s cubic-bezier(.22,.61,.36,1) infinite}
@keyframes pulseRun{0%{transform:translateX(-40%)}50%{transform:translateX(40%)}100%{transform:translateX(140%)}}

.chat-feed{display:grid;gap:10px}
.msg{background:var(--surface);border:var(--bd);border-radius:14px;padding:10px}
.msg.role-user{border-color:#ffffff2a}
.msg.role-assistant{box-shadow:0 10px 32px rgba(0,0,0,.35)}
.msg h5{margin:.2rem 0 .35rem;font-size:12px;letter-spacing:.08em;color:var(--mut);text-transform:uppercase}

.chat-composer{display:flex;gap:8px;align-items:center;position:sticky;bottom:0;
  background:linear-gradient(180deg,rgba(0,0,0,0),rgba(0,0,0,.2));
  padding:10px;border-radius:16px}
.chat-composer textarea{flex:1;min-height:44px;max-height:36vh;resize:vertical;border-radius:12px;
  padding:10px 12px;border:var(--bd);background:rgba(255,255,255,.04);color:var(--fg)}
.chat-composer .btn{white-space:nowrap}



#v-chat .chat-wrap{display:flex;flex-direction:column;gap:12px;min-height:60vh}
#v-chat .chat-feed{flex-grow:1;overflow-y:auto;max-height:60vh;padding:0 8px}
#v-chat .msg{font-size:0.95rem;line-height:1.4}
#v-chat .msg.ai{background:rgba(0,120,255,0.08)}
#v-chat .msg.user{background:rgba(255,255,255,0.05)}
#v-chat .chat-composer textarea{background:rgba(255,255,255,0.06);border-radius:8px}
#v-chat .chat-composer .btn{min-width:84px}




/* ===== ChatPlus (emoji buttons, 3-block replies, HTML rendering) ===== */
#chatFeed .msg.ai-rich {
  background: rgba(57,255,182,0.12);
  border-radius: 16px 16px 16px 0;
  padding: 8px 12px;
  max-width: 75%;
}
#chatFeed .ai-block {
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 12px;
  margin: 6px 0;
  overflow: hidden;
  background: rgba(15, 17, 32, 0.5);
}
#chatFeed .ai-block > summary {
  list-style: none;
  cursor: pointer;
  font-weight: 800;
  padding: 8px 10px;
  display: flex;
  align-items: center;
  gap: 8px;
}
#chatFeed .ai-block > summary::-webkit-details-marker { display: none; }
#chatFeed .ai-block .block-body {
  padding: 8px 10px;
  line-height: 1.55;
}
#chatFeed .ai-block .block-body :where(p, ul, ol, pre, code, h1, h2, h3, h4, h5, h6) { margin: 6px 0 }
#chatFeed .ai-block .block-body pre {
  background: rgba(0,0,0,.35);
  padding: 8px;
  border-radius: 8px;
  overflow:auto;
}
/* Emoji buttons */
.emoji-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  margin: 0 2px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.06);
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
  transition: transform .12s var(--ease), background .2s var(--ease);
}
.emoji-btn:hover { transform: translateY(-1px); background: rgba(255,255,255,0.1); }
.emoji-suggestions {
  margin-top: 6px;
  display: flex; flex-wrap: wrap; gap: 4px;
}
/* Rendered HTML box (safe) */
.render-html {
  border: 1px dashed rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.03);
  padding: 8px;
  border-radius: 10px;
}
.render-html iframe {
  width: 100%; border: 0; background: #0b0f14; border-radius: 8px;
}




/* --------------------------------------------
   KOBLLUX • Compact Mode — Mobile-first Vertical
   Colar após o CSS atual
--------------------------------------------- */

/* Base compacta + segurança */
*,
*::before,
*::after { box-sizing: border-box; }
html, body { max-width: 100%; overflow-x: hidden; }
body { padding-bottom: calc(16px + env(safe-area-inset-bottom)); }

/* Container nunca estoura, sem “gambiarra” de largura */
.response-container {
  inline-size: min(100%, calc(100% - 0px)) !important;
  padding: 1rem 0 2.75rem; /* + espaço safe-area já no body */
}

/* Nada lado a lado por padrão — empilha tudo */
.row,
.controls,
.kv,
.columns,
.split {
  display: block !important;
}

/* Qualquer tentativa de grid vira 1 coluna */
[class*="grid"],
[style*="grid-template-columns"],
.columns,
.split,
.panel,
.kv {
  display: grid !important;
  grid-template-columns: 1fr !important;
  align-items: stretch;
  gap: .5rem !important;
}

/* Pares “key→value” agora empilhados */
.kv > * { margin: 0 0 .4rem 0; }

/* Grupos de controles em coluna, ocupando 100% */
.controls .group {
  display: block !important;
  width: 100%;
  padding: .5rem .6rem;
  margin: 0 0 .6rem 0;
}
.controls .group > label,
.controls .group > select,
.controls .group > input,
.controls .group > button { display: block; width: 100%; }

/* Botões e inputs: alvo de toque ≥44px */
.btn,
select,
input[type="text"],
input[type="file"],
input[type="range"],
input[type="checkbox"],
input[type="radio"],
label[for],
textarea {
  min-height: 44px;
}

/* Botão Único: respeita safe-area no iOS */
#btnKOBLLUX { 
  bottom: calc(1rem + env(safe-area-inset-bottom));
}

/* Navegações/chips SOMENTE na header: scroll horizontal, sem wrap */
.header .row {
  display: block !important;
  overflow-x: auto;
  white-space: nowrap;
  scrollbar-width: thin;
  -webkit-overflow-scrolling: touch;
  padding-bottom: .25rem;
  margin-bottom: .25rem;
}
.header .row > * {
  display: inline-block;
  vertical-align: top;
  margin-right: .5rem;
}

/* Dropzone 100% vertical */
.dropzone .dz-area { display: block !important; }
.dropzone .row { display: block !important; }
.dropzone .row > * { display: block; width: 100%; margin: .5rem 0 0; }

/* Editor e Preview sempre empilhados (Preview abaixo)
   Use #analysis como Preview, ou crie #preview se preferir. */
.editor {
  width: 100%;
  min-height: 48vh;
  height: 52vh;          /* alvo ~50–60vh */
  max-height: 60vh;
  overflow: auto;
}
#analysis,
#preview {
  display: block;
  width: 100%;
  min-height: 42vh;
  height: 50vh;          /* alvo ~50–60vh */
  max-height: 60vh;
  overflow: auto;
  white-space: pre-wrap;  /* evita overflow lateral */
  word-wrap: break-word;
}

/* Cards/listas/painéis: pilha vertical com scroll interno quando necessário */
.response-block.glass,
.panel {
  max-height: unset;     /* deixe rolar a página */
}
.panel[data-scroll],
.response-block.glass[data-scroll],
.card[data-scroll],
[list][data-scroll] {
  max-height: 60vh;
  overflow: auto;
}

/* Controles verticais: sliders + labels exibidos em coluna */
.controls label { margin: 0 0 .25rem 0; }
.controls input[type="range"] { margin: .25rem 0 .5rem; }

/* Sliders com preenchimento dinâmico (mantém seu gradiente) */
input[type="range"]{
  /* estes tokens são calculados por JS no seu app, mantidos aqui */
  inline-size: 100%;
}

/* Toggle (Auto‑detectar): aumenta para tap ≥44px */
#autoDetect{
  --w: 72px; --h: 44px; --pad: 4px;
  min-height: 44px;
}

/* SELECT e BTN ocupam a linha inteira no modo compact */
select,
.btn { width: 100%; }

/* Grids/tabelas internas que insistem em múltiplas colunas → força 1fr */
[role="grid"],
[role="table"],
table,
.table,
.list,
.cards,
.cards-grid,
.items-grid {
  display: grid !important;
  grid-template-columns: 1fr !important;
}

/* Editor/Preview evitando sangrar lateralmente (longas strings/URLs) */
.editor,
pre { word-break: break-word; }

/* Header único (nenhum footer fixo) — nenhuma regra extra de footer */

/* Safe-area e “tap spacing” no rodapé de ações flutuantes/badges */
.badge-reopen { 
  bottom: calc(1rem + env(safe-area-inset-bottom));
}

/* Animação e sombras mais discretas (versão compact) */
.glass { padding: .75rem .9rem; }
.btn { padding: .7rem 1rem; }

/* Scroll horizontal utilitário (caso queira aplicar em outra nav) */
.h-scroll { overflow-x: auto; white-space: nowrap; }
.h-scroll > * { display: inline-block; }

/* Qualquer .columns e .split SEMPRE block (reforço final) */
.columns, .split { display: block !important; }

/* Segurança extra: força colunas únicas em componentes “teimosos” */
[class*="columns-"],
[class*="cols-"],
[class*="grid-"] {
  grid-template-columns: 1fr !important;
}

/* Evitar wrap de ícones/textos em chips sem quebrar layout */
.pill { display: inline-block; }

/* Garantir que iFrame seguro não crie overflow lateral */
.ifr { inline-size: 100%; max-inline-size: 100%; }
.ifr .bar { display: block; }
.ifr .bar .spacer { display: none; }
.ifr .bar .btn,
.ifr .bar .btn.ghost { width: 100%; margin-top: .4rem; }

/* Acessibilidade: foco visível “compact” */
:focus-visible { outline: none; box-shadow: 0 0 0 3px rgba(57,255,182,.18); }

/* Restrições finais — nada lado a lado fora da header */
main .row { display: block !important; }
main .row > * + * { margin-top: .5rem; }

/* (Opcional) reduz micro gaps gerais para versão compacta */
.stack { gap: .5rem !important; }




:root{ --ls-fg:#eaf2ff; --ls-surface:rgba(15,17,32,.9); --ls-line:rgba(255,255,255,.14); --ls-gap:10px; --ls-h:40px; --ls-r:12px; }
#lsModal .ls-panel{background:var(--ls-surface)!important;border:1px solid var(--ls-line)!important;border-radius:16px!important;padding:12px!important}
#lsModal .ls-panel .section-title{font-weight:900;font-size:12px;color:var(--ls-fg);opacity:.95;margin:8px 0 6px}
#lsModal .ls-panel .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:var(--ls-gap)}
#lsModal .ls-panel .line{display:grid;grid-template-columns:1fr 1fr;gap:var(--ls-gap);align-items:center}
#lsModal .ls-panel label{font-size:12px;opacity:.85}
#lsModal .ls-panel .pill-btn, #lsModal .ls-panel button, #lsModal .ls-panel .arch-chip, #lsModal .ls-panel .btn{
  min-height:var(--ls-h);border-radius:var(--ls-r);padding:8px 12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.18);color:var(--ls-fg);font-size:12px;letter-spacing:.2px
}
#lsModal .ls-panel .pill-btn.on, #lsModal .ls-panel .arch-chip.on{background:rgba(57,255,182,.18);border-color:rgba(57,255,182,.45)}
#lsModal .ls-panel input[type="range"], #lsModal .ls-panel select{
  min-height:var(--ls-h);border-radius:var(--ls-r);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.18);color:var(--ls-fg);padding:10px
}
#lsModal .ls-panel output{font-size:12px;opacity:.9}
#perfHud{display:flex;gap:8px;align-items:center;justify-content:space-between;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.18);border-radius:12px;padding:8px 10px;margin:8px 0}
#perfHud .stats{display:flex;gap:10px;align-items:center}
#perfHud .badge{display:inline-flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,.2);border-radius:999px;padding:4px 8px;background:rgba(255,255,255,.08);font-weight:800}



.arch-circle{
  border-radius:50% !important;
  overflow:hidden !important;
  -webkit-clip-path: circle(50% at 50% 50%); clip-path: circle(50% at 50% 50%);
  -webkit-mask-image: radial-gradient(circle at 50% 50%, #000 99.9%, transparent 100%);
          mask-image: radial-gradient(circle at 50% 50%, #000 99.9%, transparent 100%);
  isolation:isolate; contain: paint; transform: translateZ(0); will-change: transform;
  background-clip: padding-box;
}
.arch-circle > .arch-fab{
  background:none !important; mix-blend-mode: normal !important;
  backface-visibility:hidden; -webkit-backface-visibility:hidden;
}
.arch-circle > .arch-fab::before{
  content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
  background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  box-shadow:0 6px 16px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.06) inset;
}
/* failsafe de recorte para camadas do orbe */
.arch-circle > canvas, .arch-circle #orbWrap, .arch-circle .orb-slot, .arch-circle iframe#arch-frame{
  -webkit-clip-path: circle(50% at 50% 50%); clip-path: circle(50% at 50% 50%);
}



  #arch-orb-wrap{width:min(82vw,360px);aspect-ratio:1/1;display:grid;place-items:center;
    background:radial-gradient(60% 60% at 50% 45%,#0b1424 0%,#0a1120 50%,#070d1a 100%);
    border:1px solid #1a314a;border-radius:24px;box-shadow:0 0 32px #00e7ff1f,inset 0 0 24px #001b2f80;
    padding:14px;margin:10px auto}
  #arch-orb{width:100%;height:100%;display:block}
